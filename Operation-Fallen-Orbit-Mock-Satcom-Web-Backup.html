<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Operation Fallen Orbit — Repo Backup (Mock)</title>
  <style>
    :root{--bg:#0b1020;--card:#0f1724;--accent:#60a5fa;--muted:#94a3b8;--text:#e6eef8}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;background:linear-gradient(180deg,#061028 0%, #071428 100%);color:var(--text)}
    .app{display:grid;grid-template-columns:320px 1fr;gap:20px;padding:24px}
    .panel{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(2,6,23,.6)}
    h1{margin:6px 0 12px;font-size:18px}
    .tree{font-size:14px;line-height:1.6}
    .node{padding:6px 8px;border-radius:8px;display:flex;justify-content:space-between;align-items:center;cursor:pointer}
    .node:hover{background:rgba(96,165,250,.06)}
    .node .name{color:var(--text)}
    .node .meta{font-size:12px;color:var(--muted)}
    .viewer{min-height:320px}
    pre{white-space:pre-wrap;background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;overflow:auto}
    .search{display:flex;gap:8px;margin-bottom:10px}
    input[type=search]{flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)}
    .badge{background:rgba(96,165,250,.12);padding:4px 8px;border-radius:999px;font-size:12px;color:var(--accent)}
    .footer{font-size:12px;color:var(--muted);padding-top:10px}
    .hint{font-size:13px;color:var(--muted);margin-top:8px}
    .small{font-size:12px;color:var(--muted)}
    a.link{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <div class="app">
    <aside class="panel">
      <h1>Repo: system-backup-2025</h1>
      <div class="search">
        <input id="search" type="search" placeholder="Search files or content (try: telemetry, orbit, TLE)" />
        <div class="badge">Mock</div>
      </div>
      <div id="tree" class="tree"></div>
      <div class="footer">Use the tree to explore. Files are fictional and safe for training.</div>
    </aside>

    <main class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div><h1 id="title">Welcome — Repo Backup Viewer</h1>
        <div class="small">Operation Fallen Orbit — playbook test data</div></div>
        <div><span class="small">Time limit (example): 90s</span></div>
      </div>

      <div class="viewer" id="viewer">
        <p class="hint">Open files from the left to inspect. Some files are intentionally obfuscated (Base64, ROT13). Look for telemetry/orbit data.</p>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
        <button id="decodeBtn">Try quick-decode (Base64 -> text)</button>
        <button id="rawBtn">Show raw (no decoding)</button>
        <div style="flex:1"></div>
        <div class="small">Organizer: you can edit file contents inside the code to tune difficulty.</div>
      </div>
    </main>
  </div>

<script>
// Mock file system — add/remove files to tune difficulty
const files = {
  'README.md': {
    type:'text',
    content:`Operation Fallen Orbit — public backup mirror.\n\nThis mirror contains a variety of site assets, telemetry exports and logs. Some files are intentionally obfuscated for OPSEC.\n\nGoal: find orbit/telemetry data referring to the covert asset.`
  },
  'index.html':{type:'text',content:`<h3>Static staging page</h3><p>Welcome to the staging site.</p>`},
  'backup/site/config.json':{
    type:'text',
    content:JSON.stringify({site:"opsr-ui", version:"3.2.1", uplink_hint:"4F1", uplink_slot:"143.5E"},null,2)
  },
  'backup/telemetry/orbit_data.txt':{
    type:'text',
    // TLE lines are fictional but realistic-formatted; epoch date is arbitrary
    content:`TLE_LINE1=1 99999U 25001A   25034.51234567  .00000023  00000-0  10234-4 0  9991\nTLE_LINE2=2 99999  98.7123 123.4567 0012345 321.6543  45.6789 14.12345678901234`
  },
  'backup/telemetry/last_ping.log':{
    type:'text',
    content:`2025-11-21 13:20:45 UTC - Beacon lock achieved - uplink target: 4F1 - slot 143.5E` 
  },
  'backup/site/notes.txt':{
    type:'text',
    content:`dev: push complete. remember to rotate keys before deployment.\nDO NOT COMMIT: real-keys.txt` 
  },
  'backup/site/keys.b64':{
    type:'text',
    // base64 of "fake-private-key-placeholder"
    content:btoa('fake-private-key-placeholder')
  },
  'system/telemetry/geo_lock.cfg':{
    type:'text',
    content:'# DO NOT DELETE - Orbital Lock Config
SAT_ID = XR-17
ORBIT_MODE = GEO
LOCK_POSITION = 74.0E
STABILITY = HIGH'
  ,
  }
  '.git/HEAD':{
    type:'text',
    content:'ref: refs/heads/main'
  },
  '.git/logs/refs/heads/main':{
    type:'text',
    content:'25034... commit: add telemetry export\n25033... commit: initial site push'
  },
  'decoys/README_NOTICE.txt':{
    type:'text',
    content:'This folder contains decoy files. Not relevant to telemetry.'
  },
  'decoys/image_upload.jpg':{
    type:'binary',
    content:'(binary image placeholder) The real challenge is in telemetry files.'
  },
  'secret/encoded_rot13.txt':{
    type:'text',
    content:rot13('Gur TLR yvfgf vf: 1.541450 GHz')
  }
};

function rot13(str){return str.replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<='Z'?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26)});}

// Build tree
const treeEl=document.getElementById('tree');
function buildTree(){
  treeEl.innerHTML='';
  Object.keys(files).sort().forEach(path=>{
    const node = document.createElement('div');
    node.className='node';
    const name=document.createElement('div');name.className='name';name.textContent=path;
    const meta=document.createElement('div');meta.className='meta';meta.textContent=files[path].type;
    node.appendChild(name);node.appendChild(meta);
    node.addEventListener('click',()=>openFile(path));
    treeEl.appendChild(node);
  });
}

let currentPath=null; buildTree();

const viewer=document.getElementById('viewer');
function openFile(path){
  currentPath=path;
  document.getElementById('title').textContent=path;
  const f=files[path];
  if(!f){viewer.innerHTML='<pre>File not found</pre>';return}
  if(f.type==='binary'){
    viewer.innerHTML=`<pre>${f.content}\n\n(binary preview) - image not shown</pre>`;return
  }
  viewer.innerHTML=`<pre id="filecontent">${escapeHtml(f.content)}</pre>`;
}

function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

// Search
const search=document.getElementById('search');search.addEventListener('input',()=>{
  const q=search.value.trim().toLowerCase();
  const nodes=treeEl.querySelectorAll('.node');
  nodes.forEach(n=>{
    const name=n.querySelector('.name').textContent.toLowerCase();
    n.style.display = (!q || name.includes(q))? 'flex':'none';
  })
});

// Decode button
const decodeBtn=document.getElementById('decodeBtn');decodeBtn.addEventListener('click',()=>{
  if(!currentPath){alert('Open a file first');return}
  const f=files[currentPath];
  if(!f){alert('File not found');return}
  // try base64 decode
  try{
    const decoded=atob(f.content);
    viewer.innerHTML=`<pre id="filecontent">${escapeHtml(decoded)}</pre>`;
  }catch(e){
    alert('Decode failed or file is not base64. Try opening raw or check other files.');
  }
});

const rawBtn=document.getElementById('rawBtn');rawBtn.addEventListener('click',()=>{if(!currentPath){alert('Open a file first');return}openFile(currentPath)});

// initial open
openFile('README.md');

</script>
</body>
</html>
